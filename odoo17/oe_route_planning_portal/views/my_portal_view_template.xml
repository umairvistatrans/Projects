<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_my_home_visits" name="Show Visits" customize_show="True" inherit_id="portal.portal_my_home"
              priority="35">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="after">
            <div class="o_portal_docs row g-2">
                <t t-if="user_type == 'app_user'">
                    <t t-set="portal_service_category_enable" t-value="True"/>
                    <t t-call="portal.portal_docs_entry">
                        <t t-set="icon" t-value="'/project/static/src/img/tasks.svg'"/>
                        <t t-set="title">Visits</t>
                        <t t-set="url" t-value="'/my/visits'"/>
                        <t t-set="text">You can check Your assigned visits here</t>
                        <t t-set="placeholder_count" t-value="'task_count'"/>
                    </t>
                    <t t-call="portal.portal_docs_entry">
                        <t t-set="icon" t-value="'/sale/static/src/img/bag.svg'"/>
                        <t t-set="title">Products</t>
                        <t t-set="url" t-value="'/my/products'"/>
                        <t t-set="text">You can check Products from here</t>
                        <t t-set="placeholder_count" t-value="'task_count'"/>
                    </t>
                    <t t-call="portal.portal_docs_entry">
                        <t t-set="icon" t-value="'/oe_route_planning_portal/static/src/img/client-5250.svg'"/>
                        <t t-set="title">Customers</t>
                        <t t-set="url" t-value="'/my/customers'"/>
                        <t t-set="text">You can check Customers from here</t>
                        <t t-set="placeholder_count" t-value="'task_count'"/>
                    </t>
                </t>
            </div>
        </xpath>
    </template>

    <template id="portal_visits_list" name="Visits List">
        <t t-if="my_visits">
            <t t-call="portal.portal_table">
                <thead>
                    <tr>
                        <th>Visit Name</th>
                        <th>User</th>
                        <th>Customer</th>
                        <th>Pasi Code</th>
                        <th>Route</th>
                        <th>Visit Type</th>
                        <th>Visit Date</th>
                        <th class="text-end">Status</th>
                    </tr>
                </thead>
                <t t-foreach="my_visits" t-as="visit">
                    <tbody t-if="visit">
                        <a t-attf-href="/my/projects">
                            <tr t-attf-style="background-color: #{visit.visit_type == 'unplanned' and '#e6e6e6' or ''}">
                                <td class="text-start">
                                    <a t-attf-href="/my/visits/#{visit.id}?{{ keep_query() }}">
                                        <span t-att-title="visit.name" t-field="visit.name"/>
                                    </a>
                                </td>
                                <td>
                                    <span t-esc="visit.user_id.name"/>
                                </td>
                                <td>
                                    <span t-esc="visit.customer_id.name"/>
                                </td>
                                <td>
                                    <span t-esc="visit.pasi_code"/>
                                </td>
                                <td>
                                    <span t-esc="visit.route_id.name"/>
                                </td>
                                <td>
                                    <span t-field="visit.visit_type"/>
                                </td>
                                <td>
                                    <span t-field="visit.scheduled_date"/>
                                </td>
                                <td class="text-end lh-1">
                                    <span t-attf-class="badge text-bg-primary fw-normal o_text_overflow"
                                          t-field="visit.state"/>
                                </td>

                            </tr>
                        </a>
                    </tbody>
                </t>
            </t>
        </t>
    </template>
    <template id="portal_my_visits" name="My Visits">
        <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>

            <t t-call="oe_route_planning_portal.portal_searchbar_visits">
                <t t-set="title">Visits</t>
            </t>
            <t t-if="not my_visits">
                <div class="alert alert-warning" role="alert">
                    There are no Visits.
                </div>
            </t>
            <t t-call="oe_route_planning_portal.portal_visits_list"/>
        </t>
    </template>
    <template id="portal_my_home_menu_visits" name="Portal layout : Visits menu entries"
              inherit_id="portal.portal_breadcrumbs" priority="30">
        <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
            <li t-if="visit" class="breadcrumb-item active">
                <a t-attf-href="/my/visits?{{ keep_query() }}">Visits /</a>
                <t t-out="visit.name" t-if="visit.name != '/'"/>
            </li>
        </xpath>
    </template>

    <template id="portal_searchbar_visits" name="Portal Search Bar">
        <nav t-attf-class="navbar navbar-expand-lg flex-wrap mb-4 p-0 o_portal_navbar {{classes if classes else ''}}">
            <!--  Navbar breadcrumb or title  -->
            <t t-if="breadcrumbs_searchbar">
                <t t-call="oe_route_planning_portal.portal_my_home_menu_visits"/>
            </t>
            <span t-else="" class="navbar-brand mb-0 h1 me-auto" t-esc="title or 'Visits'"/>

            <!--  Collapse button -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#o_portal_navbar_content" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle filters">
                <span class="fa fa-fw fa-bars"/>
            </button>

            <!--  Collapsable content  -->
            <div class="collapse navbar-collapse flex-wrap-reverse justify-content-end gap-3 custom-collapse"
                 id="o_portal_navbar_content">
                <div class="nav flex-column flex-sm-row gap-2 ms-auto p-0 mb-3 mb-lg-0 mt-1 mt-lg-0">
                    <div t-if="searchbar_filters" class="ms-lg-2">
                        <span class="small me-1 navbar-text">Filter By:</span>
                        <div class="btn-group">
                            <button id="portal_searchbar_filters" data-bs-toggle="dropdown"
                                    class="btn btn-secondary dropdown-toggle">
                                <t t-esc="searchbar_filters.get(filterby,searchbar_filters.get('all')).get('label', 'All')"/>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="portal_searchbar_filters">
                                <t t-foreach="searchbar_filters" t-as="option">
                                    <t t-if="searchbar_filters[option].get('label')">
                                        <a t-att-href="'/my/visits' + '?' + keep_query('*', filterby=option)"
                                           t-attf-class="dropdown-item#{filterby == option and ' active' or ''}">
                                            <span t-esc="searchbar_filters[option].get('label')"/>
                                        </a>
                                    </t>
                                </t>
                            </div>
                        </div>
                    </div>
                    <t t-out="0"/>
                </div>
                <form t-if="searchbar_inputs" class="o_portal_search_panel col-md-5 col-xl-4 ms-lg-2">
                    <div class="input-group w-100">
                        <button type="button" class="btn btn-secondary border-end dropdown-toggle"
                                data-bs-toggle="dropdown"/>
                        <div class="dropdown-menu dropdown-menu-end" role="menu">
                            <t t-foreach='searchbar_inputs' t-as='input'>
                                <a t-att-href="'#' + input_value['input']"
                                   t-attf-class="dropdown-item#{search_in == input_value['input'] and ' active' or ''}">
                                    <span t-out="input_value['label']"/>
                                </a>
                            </t>
                        </div>
                        <input type="text" class="form-control" placeholder="Search" t-att-value='search'
                               name="search"/>
                        <button class="btn btn-secondary o_wait_lazy_js" type="submit">
                            <span class="oi oi-search"/>
                        </button>
                    </div>
                </form>
            </div>
        </nav>
    </template>


    <template id="portal_my_visit" name="My Visit" inherit_id="portal.portal_sidebar" primary="True">
        <xpath expr="//t[@t-call='portal.portal_layout']" position="attributes">
            <attribute name="t-call">project.task_link_preview_portal_layout</attribute>
        </xpath>
        <xpath expr="//div[hasclass('o_portal_sidebar')]" position="inside">
            <t t-set="title" t-value="visit.name"/>

            <div class="row o_project_portal_sidebar">
                <t t-call="portal.portal_record_sidebar">
                    <t t-set="classes" t-value="'col-lg-3 col-xl-4 d-print-none'"/>

                    <t t-set="entries">
                        <div class="d-flex flex-wrap flex-column gap-4">
                            <div t-if="visit.user_id or visit.partner_id" class="d-flex flex-column gap-4">
                                <div class="col-12" t-if="visit.user_id">
                                    <h6 class="flex-basis-100">
                                        <small class="text-muted">User</small>
                                    </h6>
                                    <t t-foreach="visit.user_id" t-as="user">
                                        <div t-attf-class="o_portal_contact_details d-flex flex-column gap-2 {{ 'mb-3' if len(visit.user_id) > 1 else '' }}">
                                            <div class="d-flex justify-content-start align-items-center gap-2">
                                                <img class="o_avatar o_portal_contact_img rounded"
                                                     t-att-src="image_data_uri(user.avatar_128)"/>
                                                <h6 class="mb-0" t-field="user.name"></h6>
                                            </div>
                                            <div t-out="user"
                                                 t-options='{"widget": "contact", "fields": ["email", "phone"]}'/>
                                        </div>
                                    </t>
                                </div>
                                <div class="col-12 d-flex flex-column" t-if="visit.customer_id">
                                    <h6>
                                        <small class="text-muted">Customer</small>
                                    </h6>
                                    <t t-if="visit.customer_id">
                                        <div class="o_portal_contact_details d-flex flex-column gap-2">
                                            <div class="d-flex justify-content-start align-items-start flex-column gap-1">
                                                <img class="o_avatar o_portal_contact_img rounded"
                                                     t-att-src="image_data_uri(visit.customer_id.avatar_128)"/>
                                                <h6 class="mb-0" t-out="visit.customer_id.name"></h6>
                                            </div>
                                            <div t-field="visit.customer_id"
                                                 t-options='{"widget": "contact", "fields": ["address", "email", "phone"]}'/>
                                        </div>
                                    </t>
                                </div>
                            </div>
                        </div>
                    </t>
                </t>
                <div id="task_content" class="o_portal_content col-12 col-lg-9 col-xl-8">
                    <div id="card">
                        <div id="card_header" data-anchor="true">
                            <div class="row justify-content-between align-items-end mb-3">
                                <div class="col-12 col-md-9">
                                    <div class="d-flex align-items-center gap-2">
                                        <!--                                        <t t-call="project.portal_my_tasks_priority_widget_template">-->
                                        <!--                                            <t t-set="classes" t-translation="off">fs-4</t>-->
                                        <!--                                        </t>-->
                                        <h3 t-field="visit.name" class="text-truncate my-0"/>
                                        <small class="text-muted d-none d-md-inline align-self-end">(#<span
                                                t-field="visit.id"/>)
                                        </small>
                                    </div>
                                </div>
                                <div class="col-auto">
                                    <small class="text-end">Status:</small>
                                    <span t-field="visit.state" class=" badge rounded-pill text-bg-info"
                                          title="Current status of this visit"/>
                                </div>
                            </div>
                        </div>
                        <div id="card_body">
                            <div class="float-end">
                                <!--                                <t t-call="project.portal_my_tasks_state_widget_template">-->
                                <!--                                    <t t-set="path" t-value="'visit'"/>-->
                                <!--                                </t>-->
                            </div>
                            <div class="row mb-4 container">
                                <div class="col-12 col-md-6 flex-grow-1">
                                    <!--                                    <div t-if="project_accessible">-->
                                    <!--                                        <strong>Project:</strong>-->
                                    <!--                                        <a t-attf-href="/my/projects/#{task.project_id.id}" t-field="task.project_id"/>-->
                                    <!--                                    </div>-->
                                    <!--                                    <div t-else="">-->
                                    <!--                                        <strong>Project:</strong>-->
                                    <!--                                        <a t-field="task.project_id"/>-->
                                    <!--                                    </div>-->
                                    <div t-if="visit.scheduled_date">
                                        <strong>Scheduled Date:</strong>
                                        <span t-field="visit.scheduled_date" t-options='{"widget": "date"}'/>
                                    </div>
                                    <div t-if="visit.start_date_time">
                                        <strong>Check-In Time:</strong>
                                        <span t-field="visit.start_date_time" t-options='{"format": "HH:mm"}'/>
                                    </div>
                                    <div t-if="visit.end_date_time">
                                        <strong>Check-Out Time:</strong>
                                        <span t-field="visit.end_date_time" t-options='{"format": "HH:mm"}'/>
                                    </div>


                                    <!--                                    <div t-if="task.milestone_id and task.allow_milestones">-->
                                    <!--                                        <strong>Milestone:</strong>-->
                                    <!--                                        <span t-field="task.milestone_id"/>-->
                                    <!--                                    </div>-->
                                    <!--                                    <div name="portal_my_task_allocated_hours">-->
                                    <!--                                        <strong t-if="task.allocated_hours > 0">Allocated Time:</strong>-->
                                    <!--                                        <t t-call="project.portal_my_task_allocated_hours_template"/>-->
                                    <!--                                    </div>-->
                                </div>
                                <div class="col-12 col-md-6 d-empty-none" name="portal_my_task_second_column"></div>
                            </div>

                            <div class="row" t-if="visit.name or visit.photo_ids">
                                <div t-if="not is_html_empty(visit.name)"
                                     t-attf-class="col-12 mb-4 mb-md-0 {{'col-lg-6' if visit.photo_ids else 'col-lg-12'}}">
                                    <hr class="mb-1"/>
                                    <div class="d-flex my-2">
                                        <h5>Description</h5>
                                    </div>
                                    <div class="py-1 px-2 bg-100 small table-responsive" t-field="visit.name"/>
                                </div>
                                <!--                                <div t-if="visit.photo_ids"-->
                                <!--                                     t-attf-class="col-12 o_project_portal_attachments {{'col-lg-6' if visit.name else 'col-lg-12'}}">-->
                                <!--                                    <hr class="mb-1 d-none d-lg-block"/>-->
                                <!--                                    <strong class="d-block mb-2">Attachments</strong>-->
                                <!--                                    <div class="row">-->
                                <!--                                        <div t-attf-class="col {{'col-lg-6' if not visit.name else 'col-lg-12'}}">-->
                                <!--                                            <ul class="list-group">-->
                                <!--                                                <a class="list-group-item list-group-item-action d-flex align-items-center oe_attachments py-1 px-2"-->
                                <!--                                                   t-foreach='visit.photo_ids' t-as='attachment'-->
                                <!--                                                   t-attf-href="/web/content/#{attachment.id}?download=true&amp;access_token=#{attachment.access_token}"-->
                                <!--                                                   target="_blank" data-no-post-process="">-->
                                <!--                                                    <div class='oe_attachment_embedded o_image o_image_small me-2 me-lg-3'-->
                                <!--                                                         t-att-title="attachment.name"-->
                                <!--                                                         t-att-data-mimetype="attachment.mimetype"-->
                                <!--                                                         t-attf-data-src="/web/image/#{attachment.id}/50x40?access_token=#{attachment.access_token}"/>-->
                                <!--                                                    <div class='oe_attachment_name text-truncate'>-->
                                <!--                                                        <t t-esc='attachment.name'/>-->
                                <!--                                                    </div>-->
                                <!--                                                </a>-->
                                <!--                                            </ul>-->
                                <!--                                        </div>-->
                                <!--                                    </div>-->
                                <!--                                </div>-->
                            </div>

                            <div class="feedback-div">
                                <textarea placeholder="Feedback" rows="4"></textarea>
                            </div>

                            <div t-if="visit.state != 'cancelled'" class="parallel-btn-div">
                                <div t-if="visit.state != 're_scheduled' and visit.state != 'completed'">
                                <button name="Request For Re-Schedule" class="request-reschedule-btn"
                                        t-att-data-visit-id="visit.id">Request For Re-Schedule
                                </button>
                                </div>
                                <div t-if="not visit.start_date_time">
                                    <button name="check in" class="checkin-btn" data-action="checkin"
                                            t-att-data-visit-id="visit.id">Check In
                                    </button>
                                </div>
                                <div t-if="not visit.end_date_time and visit.state != 'cancelled'">
                                    <button name="Request For Cancel" class="request-cancel-btn"
                                            t-att-data-visit-id="visit.id">Request For Cancel
                                    </button>
                                </div>
                            </div>
                            <div t-if="visit.start_date_time" id="company_product_content">
                                <div class="tab">
                                    <button class="tablinks active">Company Products</button>
                                    <button class="tablinks">Company Materials</button>
                                    <button class="tablinks">Competitor Products</button>
                                    <button class="tablinks">Competitor Materials</button>
                                </div>

                                <div id="Company Products" class="tabcontent" style="display:block">
                                    <div class="container">
                                        <div class="row">
                                            <t t-foreach="company_product" t-as='product'>
                                                <div class="col-md-4 mb-4">
                                                    <div class="card custom-card-class">
                                                        <div class="card-body">
                                                            <img
                                                                    t-att-src="'/web/image?model=product.product&amp;field=image_128&amp;id=%s' % product.id"
                                                                    alt="Product"/>
                                                            <!-- <t t-esc="product.id" style="display:none"/> -->
                                                            <h5 class="card-title">
                                                                <t t-esc="product.name"/>
                                                            </h5>
                                                            <p>
                                                                <br/>
                                                                <input type="radio"
                                                                       t-att-name="'type_availability_' + str(product.id)"
                                                                       value="availability"
                                                                       t-att-class="'availability_' + str(product.id)"
                                                                       t-att-id="'type_availability_' + str(product.id) + '_1'"
                                                                       t-att-data-product-id="product.id"
                                                                />
                                                                <label
                                                                        t-att-for="'type_availability_' + str(product.id) + '_availability'">
                                                                    Available
                                                                </label>
                                                                <br/>
                                                                <input type="radio"
                                                                       t-att-name="'type_availability_' + str(product.id)"
                                                                       value="not_availability"
                                                                       t-att-class="'not_availability_' + str(product.id)"
                                                                       t-att-id="'type_availability_' + str(product.id) + '_2'"
                                                                       t-att-data-product-id="product.id"
                                                                       checked="checked"
                                                                />
                                                                <label
                                                                        t-att-for="'type_availability_' + str(product.id) + '_not_availability'">
                                                                    Not Available
                                                                </label>
                                                                <br/>
                                                                <input type="radio"
                                                                       t-att-name="'type_availability_' + str(product.id)"
                                                                       value="out_of_stock"
                                                                       t-att-class="'out_of_stock_' + str(product.id)"
                                                                       t-att-id="'type_availability_' + str(product.id) + '_3'"
                                                                       t-att-data-product-id="product.id"
                                                                />
                                                                <label
                                                                        t-att-for="'type_availability_' + str(product.id) + '_out_of_stock'">
                                                                    Out Of Stock
                                                                </label>
                                                                <br/>
                                                            </p>
                                                            <p class="card-text qty-input-custom">
                                                                <input type="number" placeholder="Qty"
                                                                       id="qty_input_{{ product.id }}"
                                                                       name="qty" style="width:100px;display:none;"
                                                                       t-att-data-product-id="product.id"
                                                                       class="qty_input"/>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>

                                <div id="Company Material" class="tabcontent">
                                    <div class="container">
                                        <div class="row">
                                            <t t-foreach="material_product" t-as='product'>
                                                <div class="col-md-4 mb-4">
                                                    <div class="card custom-card-class"
                                                         t-att-data-product-id="product.id">
                                                        <div class="card-body">
                                                            <img t-att-src="'/web/image?model=product.product&amp;field=image_128&amp;id=%s' % product.id"
                                                                 alt="Product"/>
                                                            <h5 class="card-title">
                                                                <t t-esc="product.name"/>
                                                            </h5>
                                                            <h6 class="card-brand">
                                                                <t t-esc="product.brand_id.name"/>
                                                            </h6>
                                                            <div class="comment-boxx-comp-material">
                                                                <textarea class="qty_input"
                                                                          placeholder="Comment"></textarea>
                                                            </div>
                                                            <div class="upload-boxx-comp-material">
                                                                <input type="file" class="image_upload"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>

                                <div id="Competitor Products" class="tabcontent">
                                    <div class="container">
                                        <div class="row">
                                            <t t-foreach="competitor_product" t-as='product'>
                                                <div class="col-md-4 mb-4">
                                                    <div class="card custom-card-class"
                                                         t-att-data-product-id="product.id">
                                                        <div class="card-body">
                                                            <img t-att-src="'/web/image?model=product.product&amp;field=image_128&amp;id=%s' % product.id"
                                                                 alt="Product"/>
                                                            <h5 class="card-title">
                                                                <t t-esc="product.name"/>
                                                            </h5>
                                                            <h6 class="card-brand">
                                                                <t t-esc="product.brand_id.name"/>
                                                            </h6>
                                                            <div class="comment-boxx-competitor-pro">
                                                                <textarea class="qty_input"
                                                                          placeholder="Comment"></textarea>
                                                            </div>
                                                            <div class="upload-boxx-competitor-pro">
                                                                <input type="file" class="image_upload"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div>

                                <div id="Competitor Materials" class="tabcontent">
                                    <div class="container">
                                        <div class="row">
                                            <t t-foreach="competitor_material" t-as='product'>
                                                <div class="col-md-4 mb-4">
                                                    <div class="card custom-card-class"
                                                         t-att-data-product-id="product.id">
                                                        <div class="card-body">
                                                            <img t-att-src="'/web/image?model=product.product&amp;field=image_128&amp;id=%s' % product.id"
                                                                 alt="Product"/>
                                                            <h5 class="card-title">
                                                                <t t-esc="product.name"/>
                                                            </h5>
                                                            <h6 class="card-brand">
                                                                <t t-esc="product.brand_id.name"/>
                                                            </h6>
                                                            <div class="comment-boxx-competitor-mat">
                                                                <textarea class="qty_input"
                                                                          placeholder="Comment"></textarea>
                                                            </div>
                                                            <div class="upload-boxx-competitor-mat">
                                                                <input type="file" class="image_upload"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </div><br/><br/><br/>
                                <div class="multi-upload">
                                    <input type="file" class="multiple_image_upload" multiple=""/>
                                    <div class="multi-image-preview"></div>
                                </div>
                                <div t-if="not visit.end_date_time and visit.state != 'cancelled'" name="Save Button" style="text-align: center;">
                                    <a class="btn btn-primary m-3 p-3 save_button current_position"
                                       data-action="checkout"
                                       t-att-data-visit-id="visit.id">Checkout
                                    </a>
                                </div>
                                <div class="coordinates"></div>
                            </div>

                        </div>
                    </div>
                    <div id="visit_chat" data-anchor="true">
                        <h3>Communication History</h3>
                        <t t-call="portal.message_thread">
                            <t t-set="object" t-value="visit"/>
                            <t t-set="token" t-value="access_token"/>
                        </t>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <!-- Calendar View -->
    <template id="portal_visit_calendar" name="visit calendar"
              inherit_id="oe_route_planning_portal.portal_searchbar_visits">
        <xpath expr="//nav" position="after">
            <div id="calendar-div">
                <div id="calendar">
                    <t t-set="displayed_month_id"
                       t-value="month_kept_from_update if month_kept_from_update is not False else month_first_available"/>
                    <div t-foreach="slots" t-as="month" t-attf-id="month-#{month['id']}" t-attf-class="o_appointment_month #{'d-none' if month['id'] != displayed_month_id else ''}">
                        <div id="calendarHeader" class="position-relative d-flex align-items-center p-3 border-bottom">
                            <button t-if="month['seq_id'] > 0" type="button" id="prevCal"
                                    class="btn btn-light o_js_calendar_navigate position-absolute top-50 start-0 ms-2 translate-middle-y">
                                <i class="oi oi-chevron-left"/>
                            </button>
                            <h5 t-out="month['month']" class="o_appointment_month_name mx-auto mb-0"/>
                            <button t-if="len(slots) > month['seq_id'] + 1" type="button" id="nextCal"
                                    class="btn btn-light o_js_calendar_navigate position-absolute top-50 end-0 me-2 translate-middle-y">
                                <i class="oi oi-chevron-right"/>
                            </button>
                        </div>
                        <table class="w-100">
                            <tr class="o_website_calendar_weekdays">
                                <t t-foreach="formatted_days" t-as="day">
                                    <th class="py-2 text-center">
                                        <small t-out="day"/>
                                    </th>
                                </t>
                            </tr>
                            <tr t-foreach="month['weeks']" t-as="weeks" class="o_appointment_days">
                                <t t-foreach="weeks" t-as="day">
                                    <td t-attf-class="text-center"
                                        t-attf-title="">
                                        <t>
                                            <div t-att-id="day['date']"
                                                 t-attf-class="o_day_wrapper o_slot_button btn btn-outline-primary d-block position-relative m-1 p-2 border"
                                                 t-out="day['date'].day"
                                                 t-att-data-slot-date="day['date']"/>
                                        </t>
                                        <!--                                    <t>-->
                                        <!--                                        <div t-out="day['date'].day" t-attf-class="o_day_wrapper border border-transparent  position-relative m-1 p-2"/>-->
                                        <!--                                    </t>-->
                                    </td>
                                </t>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <!-- Toggle Button -->
    <template id="portal_list_calendar_toggle" name="List Calendar Toggler"
              inherit_id="oe_route_planning_portal.portal_searchbar_visits">
        <xpath expr="//div[hasclass('nav')]" position="inside">
            <div class="parent-custom">
                <button class="list-btn-calendar">
                    <i class="fa fa-calendar"/>
                </button>
                <button class="list-btn-list">
                    <i class="oi oi-view-list"/>
                </button>
            </div>
        </xpath>
    </template>

</odoo>
