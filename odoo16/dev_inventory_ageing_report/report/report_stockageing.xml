<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="external_inv_ageing_report_header">
        <!-- Multicompany -->
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>

        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"/>
        </t>
        <t t-call="dev_inventory_ageing_report.external_inv_ageing_report_layout"><t t-raw="0"/></t>
    </template>

    <template id="external_inv_ageing_report_layout">
        <div class="header">
        </div>

         <div class="article o_report_layout_standard">
            <t t-raw="0" />
        </div>

        <div class="footer">
            <div class="text-center">
                <div class="text-muted" style="color:#000">
                    Page:
                    <span class="page"/>
                    of
                    <span class="topage"/>
                </div>
            </div>
        </div>
    </template>

	<template id="dev_inv_ageing_temp">
		<t t-call="web.html_container">
	        <t t-call="dev_inventory_ageing_report.external_inv_ageing_report_header">
                <div class="page" style="font-size:12px;color:#000">
                    <style>
                        .header_table{
                            width:100%;
                        }
                        .header_table th{
                            padding:5px;
                            text-align:center;
                            border:1px solid black;
                            background:#c8cace;
                        }
                        .header_table td{
                            padding:5px;
                            text-align:center;
                            border:1px solid black;
                        }
                        .my_table{
                            width:100%;
                        }
                        .my_table th{
                            padding:5px;
                        }
                        .my_table .bottom_my_table th{
                            border-bottom:1px solid #000;
                        }
                        .my_table td{
                            padding:5px;
                            border-bottom:1px solid #efefef;
                        }
                    </style>
                    <div class="row">
                        <center><h3>INVENTORY AGEING REPORT</h3></center><br/>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <table class="header_table">
                                <thead>
                                    <tr>
                                        <th style="width:16.66%"> Company </th>
                                        <th style="width:16.66%"> Warehouse </th>
                                        <th style="width:16.66%"> Location </th>
                                        <th style="width:16.66%"> Date </th>
                                        <th style="width:16.66%"> Generated By </th>
                                        <th style="width:16.66%"> Period Length (Days) </th>
                                    </tr>
                                </thead>
                                <tbody class="sale_tbody">
                                    <tr>
                                        <td> <span t-esc="docs.company_id.name"/></td>
                                        <td> <span t-esc="', '.join(map(lambda x: x.name, docs.warehouse_ids))"/> </td>
                                        <td> <span t-esc="docs.location_ids.name"/></td>
                                        <td>
                                            <span t-esc="docs.date_from" t-options='{"widget": "date"}'/>
                                        </td>
                                        <td> <span t-esc="user.name"/> </td>
                                        <td> <span t-esc="docs.period_length"/> </td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>

                    <div class="row mt32 mb32"/>

                    <div class="row">
                        <div class="col-xs-12">
                            <table class="my_table">
                                <thead>
                                    <tr>
                                        <th width="14%" style="background:#d6d6d6">Code</th>
                                        <th width="30%"  style="background:#d6d6d6">Product </th>
                                        <t t-set="res" t-value="docs.get_aging_detail()"/>
                                        <t t-foreach="get_loop()" t-as="i">
                                            <th width="8%" class="text-end"  style="background:#d6d6d6">
                                                <span t-esc="res[i]['name']"/>
                                            </th>
                                        </t>

                                    </tr>
                                </thead>
                                <tbody class="sale_tbody">
                                    <t t-set="products" t-value="docs.get_products()"/>
                                    <t t-set="total" t-value="{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0}"/>
                                    <t t-foreach="products" t-as="product">
                                        <tr style="page-break-inside: avoid">
                                            <td> <span t-esc="product.default_code or ''"/></td>
                                            <td> <span t-esc="product.name or ''"/></td>
                                            <t t-set="val" t-value="get_values(docs,product)"/>
                                            <t t-foreach="get_loop()" t-as="i">
                                                <td width="8%" class="text-end">
                                                    <t t-set="total" t-value="set_total_value(total,val[i],i)"/>
                                                    <span t-esc="get_formate_amount(val[i])"/>
                                                </td>
                                            </t>
                                        </tr>
                                    </t>
                                    <tr style="page-break-inside: avoid">
                                        <td class="text-start" colspan="2"> <b>TOTAL</b> </td>
                                        <t t-foreach="get_loop()" t-as="i">
                                            <td width="8%" class="text-end">
                                                <b><span t-esc="get_formate_amount(total[i])"/></b>
                                            </td>
                                        </t>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <p style="page-break-before:always;"> </p>
                </div>
	        </t>
		</t>
	</template>
</odoo>
